(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[3],{107:function(e,a,t){e.exports=t.p+"static/media/qudra-lake-cover.6f48cf29.jpg"},108:function(e,a,t){e.exports={detail_cover:"Tourdetail_detail_cover__KIy0R",container:"Tourdetail_container__14MU9","detail-heading":"Tourdetail_detail-heading__2Qxf5","detail-heading__info":"Tourdetail_detail-heading__info__2r67z","detail-icons":"Tourdetail_detail-icons__1abz7","detail-icons__icon":"Tourdetail_detail-icons__icon__2kxaG"}},109:function(e,a,t){e.exports={description:"TourDescription_description__2SUSI",description__text:"TourDescription_description__text__2BlEE",description__photo:"TourDescription_description__photo__2GPF1"}},110:function(e,a,t){e.exports=t.p+"static/media/qudra-image-1.6da533b1.jpeg"},111:function(e,a,t){e.exports=t.p+"static/media/qudra-image-2.af17121a.jpg"},112:function(e,a,t){e.exports=t.p+"static/media/qudra-image-3.ab07df18.jpg"},113:function(e,a,t){e.exports={"key-details":"TourStats_key-details__2LWYj",guides__section:"TourStats_guides__section__2SsDW",guides:"TourStats_guides__1a5Tt",guides__shape:"TourStats_guides__shape__3nEC6",guides__caption:"TourStats_guides__caption__eZ6ZB","detail-box":"TourStats_detail-box__1v3nx","detail-box__detail":"TourStats_detail-box__detail__3KTrP","detail-box__icon":"TourStats_detail-box__icon__1IWvH","detail-box__label":"TourStats_detail-box__label__3rdUP"}},114:function(e,a,t){e.exports=t.p+"static/media/zoomi.9b8f186f.jpeg"},116:function(e,a,t){e.exports={mapContainer:"Map_mapContainer__3J1UR",marker:"Map_marker__1cD1H"}},119:function(e,a,t){e.exports={review:"Reviews_review__5bUpP"}},120:function(e,a,t){e.exports={review__card:"Review_review__card__OMTux",review__img:"Review_review__img__3yYq1",review__desc:"Review_review__desc__2tUYb",review__header:"Review_review__header__2XzPA",review__rating:"Review_review__rating__SGWeJ",reviews__star:"Review_reviews__star__3qLaM","reviews__star--active":"Review_reviews__star--active__2TqOE"}},121:function(e,a,t){e.exports=t.p+"static/media/zoomi.9b8f186f.jpeg"},122:function(e,a,t){"use strict";t.r(a);var n=t(3),i=t.n(n),s=t(6),r=t(9),c=t(10),o=t(12),l=t(11),d=t(0),_=t.n(d),u=t(107),m=t.n(u),p=t(15),v=t.n(p),g=t(108),f=t.n(g),h=t(13),E=t(109),b=t.n(E),x=t(110),w=t.n(x),N=t(111),k=t.n(N),y=t(112),j=t.n(y),T=t(22),O=function(e){var a,t=[w.a,k.a,j.a];return a=e.desc.images.map((function(e,a){return _.a.createElement("img",{key:a,src:"".concat(T.a.IMAGES_PATH,"/tours/").concat(e),alt:"tour place ".concat(a+1),onError:function(e){var n;n=t[a],e.target.src=n}})})),_.a.createElement("div",{className:b.a.description},_.a.createElement("p",{className:b.a.description__text},e.desc.description),e.desc.images.length>0&&_.a.createElement("div",{className:b.a.description__photo},a))},S=t(28),D=t(113),z=t.n(D),C=t(114),L=t.n(C),M=t(19),H=t(24),A=t(115),I=t(5),R=function(e,a,t){return Object(s.a)(i.a.mark((function n(){return i.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t.isAuthenticated){n.next=4;break}t.history.push("/auth/login?path=".concat(t.location.pathname)),n.next=13;break;case 4:return n.prev=4,a(!0),n.next=8,e.stripe.redirectToCheckout({sessionId:e.sessionDetail.data.session.id});case 8:n.next=13;break;case 10:n.prev=10,n.t0=n.catch(4),a(!1);case 13:case"end":return n.stop()}}),n,null,[[4,10]])})))},q=Object(I.b)((function(e){return{isAuthenticated:!!e.auth.token}}))(Object(H.h)((function(e){var a=Object(d.useState)(!0),t=Object(S.a)(a,2),n=t[0],r=t[1],c=new Date(e.details.startDate[0]).toLocaleDateString("en-us",{month:"short",year:"numeric",day:"2-digit"}),o=Object(d.useState)({sessionDetail:{},stripe:{}}),l=Object(S.a)(o,2),u=l[0],m=l[1];return Object(d.useEffect)((function(){if(!e.isAuthenticated)return r(!1),function(){return!1};var a=Object(A.a)("pk_test_hHR7Lrw7Dii4oWxrN8XMjTLL00QcU9lqxb");function t(){return(t=Object(s.a)(i.a.mark((function t(){var n,s;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s={},t.next=3,h.a.get("/bookings/checkout-session/".concat(e.id));case 3:return s=t.sent,t.next=6,a;case 6:n=t.sent,m({sessionDetail:s,stripe:n}),r(!1);case 9:case"end":return t.stop()}}),t)})))).apply(this,arguments)}return function(){t.apply(this,arguments)}(),function(){m({sessionDetail:{},stripe:{}})}}),[e.id,e.isAuthenticated]),_.a.createElement("div",{className:z.a["key-details"]},_.a.createElement("div",{className:z.a.guides__section},_.a.createElement("h2",null,"Your tour guides"),_.a.createElement("div",{className:z.a.guides},_.a.createElement("figure",{className:z.a.guides__shape},_.a.createElement("img",{src:L.a,alt:"shape",className:z.a.guides__image}),_.a.createElement("figcaption",{className:z.a.guides__caption},_.a.createElement("span",null,"lead Guide"),"zoomi")),_.a.createElement("figure",{className:z.a.guides__shape},_.a.createElement("img",{src:L.a,alt:"shape",className:z.a.guides__image}),_.a.createElement("figcaption",{className:z.a.guides__caption},_.a.createElement("span",null,"Guide"),"zoomi")),_.a.createElement("figure",{className:z.a.guides__shape},_.a.createElement("img",{src:L.a,alt:"shape",className:z.a.guides__image}),_.a.createElement("figcaption",{className:z.a.guides__caption},_.a.createElement("span",null,"Guide"),"zamurd ali")))),_.a.createElement("div",{className:z.a["detail-box"]},_.a.createElement("h2",null,"Key Details"),_.a.createElement("ul",null,_.a.createElement("li",{className:z.a["detail-box__detail"]},_.a.createElement("svg",{className:z.a["detail-box__icon"]},_.a.createElement("use",{xlinkHref:"".concat(v.a,"#icon-calendar")})),_.a.createElement("span",{className:z.a["detail-box__label"]},"Next date"),_.a.createElement("span",{className:z.a["detail-box__text"]},c)),_.a.createElement("li",{className:z.a["detail-box__detail"]},_.a.createElement("svg",{className:z.a["detail-box__icon"]},_.a.createElement("use",{xlinkHref:"".concat(v.a,"#icon-flag")})),_.a.createElement("span",{className:z.a["detail-box__label"]},"DIFFICULTY"),_.a.createElement("span",{className:z.a["detail-box__text"]},e.details.difficulty)),_.a.createElement("li",{className:z.a["detail-box__detail"]},_.a.createElement("svg",{className:z.a["detail-box__icon"]},_.a.createElement("use",{xlinkHref:"".concat(v.a,"#icon-star")})),_.a.createElement("span",{className:z.a["detail-box__label"]},"rating"),_.a.createElement("span",{className:z.a["detail-box__text"]},e.details.rating,"/5")),_.a.createElement("li",{className:z.a["detail-box__detail"]},_.a.createElement("svg",{className:z.a["detail-box__icon"]},_.a.createElement("use",{xlinkHref:"".concat(v.a,"#icon-price-tag")})),_.a.createElement("span",{className:z.a["detail-box__label"]},"price"),_.a.createElement("span",{className:z.a["detail-box__text"]},e.details.price," $"))),_.a.createElement(M.a,{btnType:"btn--primary",btnSize:"btn--small",classes:"mt-1",disabled:n,clicked:R(u,r,e)},n?"loading":"Book now")))}))),P=t(116),G=t.n(P),U=t(117),J=t.n(U);t(118);J.a.accessToken="pk.eyJ1Ijoiem9vbWktcmFqYSIsImEiOiJjazl6NDhvMDcwdXN2M3RwazlzbzF4OWFiIn0.1n67PHfJehyEBhaym3zScQ";var W=function(e){Object(o.a)(t,e);var a=Object(l.a)(t);function t(){return Object(r.a)(this,t),a.apply(this,arguments)}return Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this.props.locations,a=document.createElement("link");a.href="https://api.mapbox.com/mapbox-gl-js/v1.8.1/mapbox-gl.css",a.rel="stylesheet",a.async=!0,document.head.appendChild(a);var t=new J.a.Map({container:this.mapContainer,style:"mapbox://styles/zoomi-raja/ck9z6jm6j2rhz1io9fektfzw9",scrollZoom:!1}),n=new J.a.LngLatBounds;e.forEach((function(e){if(e.coordinates.length>0){var a=document.createElement("div");a.className=G.a.marker,new J.a.Marker({element:a,anchor:"bottom"}).setLngLat(e.coordinates).addTo(t),new J.a.Popup({offset:30}).setLngLat(e.coordinates).setHTML("<p>Day ".concat(e.day,": ").concat(e.description,"</p>")).addTo(t),n.extend(e.coordinates)}})),n.isEmpty()||t.fitBounds(n,{padding:40})}},{key:"render",value:function(){var e=this;return _.a.createElement("div",{ref:function(a){return e.mapContainer=a},className:G.a.mapContainer})}}]),t}(_.a.Component),B=t(119),F=t.n(B),Y=t(120),K=t.n(Y),Q=t(121),X=t.n(Q),Z=function(e){for(var a=Math.ceil(e.rating),t=[],n=0;n<5;n++){var i=K.a.reviews__star;n<a&&(i=[K.a.reviews__star,K.a["reviews__star--active"]].join(" ")),t.push(_.a.createElement("svg",{className:i,key:n},_.a.createElement("use",{xlinkHref:"".concat(v.a,"#icon-star")})))}return _.a.createElement("div",{className:K.a.review__card},_.a.createElement("figure",{className:K.a.review__img},_.a.createElement("img",{src:X.a,alt:"user"})),_.a.createElement("div",{className:K.a.review__desc},_.a.createElement("div",{className:K.a.review__header},_.a.createElement("p",null,e.user.name,_.a.createElement("span",null,"Created at:"," ",new Date(e.createdAt).toLocaleString("en-us",{month:"short",year:"numeric",day:"2-digit"}))),_.a.createElement("div",{className:K.a.review__rating},t)),_.a.createElement("div",{className:K.a.review__text},e.review)))},$=t(21),V=function(e){Object(o.a)(t,e);var a=Object(l.a)(t);function t(){var e;Object(r.a)(this,t);for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return(e=a.call.apply(a,[this].concat(i))).state={reviews:[],loading:!0},e}return Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=Object(s.a)(i.a.mark((function e(){var a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.a.get("/tours/".concat(this.props.tourId,"/reviews"));case 2:a=e.sent,this.setState({reviews:a.data.data.review,loading:!1});case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e;if(this.state.loading)e=_.a.createElement("div",{style:{backgroundColor:"#fff"}},_.a.createElement($.a,null));else{var a=this.state.reviews.map((function(e,a){return _.a.createElement(Z,Object.assign({key:a},e))}));e=_.a.createElement("div",{className:F.a.review},a)}return e}}]),t}(_.a.Component),ee=function(e){Object(o.a)(t,e);var a=Object(l.a)(t);function t(e){var n;return Object(r.a)(this,t),(n=a.call(this,e)).makeApiCall=Object(s.a)(i.a.mark((function e(){var a,t,s=arguments;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=s.length>0&&void 0!==s[0]&&s[0],e.prev=1,e.next=4,h.a.get("/tours/".concat(n.props.match.params.id));case 4:t=e.sent,n.setState({tour:t.data.data.tour,loading:!1,error:{status:!1}}),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(1),n.setState({error:{status:!0,message:e.t0.message},loading:!1}),a&&alert(e.t0.message+": in tourDetail.js");case 12:case"end":return e.stop()}}),e,null,[[1,8]])}))),n.state={tour:{},loading:!0,error:{status:!1,message:""}},n}return Object(c.a)(t,[{key:"componentDidMount",value:function(){this.makeApiCall()}},{key:"render",value:function(){var e=this;return this.state.loading?_.a.createElement($.a,null):this.state.error.status?_.a.createElement("p",{style:{padding:"5rem",fontSize:"1.6rem"}},this.state.error.message,_.a.createElement("span",{style:{marginLeft:"1rem",cursor:"pointer"},onClick:function(){e.setState({loading:!0}),e.makeApiCall(!0)}},"click to retry")):_.a.createElement("section",{id:"tour-detail"},_.a.createElement("div",{className:f.a.detail_cover,style:{background:"url(".concat(m.a,") no-repeat center center/cover")}}),_.a.createElement("div",{className:["container",f.a.container].join(" ")},_.a.createElement("div",{className:f.a["detail-heading"]},_.a.createElement("h1",{className:f.a["detail-heading__title"]},this.state.tour.name),_.a.createElement("div",{className:f.a["detail-heading__info"]},_.a.createElement("div",{className:f.a["detail-icons"]},_.a.createElement("svg",{className:f.a["detail-icons__icon"]},_.a.createElement("use",{xlinkHref:"".concat(v.a,"#icon-calendar")})),_.a.createElement("span",null,this.state.tour.duration," days")),_.a.createElement("div",{className:f.a["detail-icons"]},_.a.createElement("svg",{className:f.a["detail-icons__icon"]},_.a.createElement("use",{xlinkHref:"".concat(v.a,"#icon-location-pin")})),_.a.createElement("span",null,this.state.tour.startLocation.description)),_.a.createElement("div",{className:f.a["detail-icons"]},_.a.createElement("svg",{className:f.a["detail-icons__icon"]},_.a.createElement("use",{xlinkHref:"".concat(v.a,"#icon-user")})),_.a.createElement("span",null,this.state.tour.maxGroupSize," People")))),_.a.createElement("div",{className:"bottom-line"}),_.a.createElement(O,{desc:{images:this.state.tour.images,description:this.state.tour.description}}),_.a.createElement(q,{id:this.state.tour.id,guides:this.state.tour.guides,details:{startDate:this.state.tour.startDates,difficulty:this.state.tour.difficulty,rating:this.state.tour.ratingsAverage,price:this.state.tour.price}}),_.a.createElement(W,{locations:this.state.tour.locations}),_.a.createElement(V,{tourId:this.props.match.params.id})))}}]),t}(_.a.Component);a.default=ee}}]);
//# sourceMappingURL=3.31faf1a4.chunk.js.map